<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Telecom Call Graph</title>
  <script src="https://unpkg.com/cytoscape@3.24.0/dist/cytoscape.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #f5f5f5;
    }
    #cy {
      width: 100%;
      height: 100vh;
      display: block;
    }
  </style>
</head>
<body>
  <div id="cy"></div>

  <script>
    const data = {
      nodes: [
        { data: { id: "+6591234567", telco: "Singtel", location: "Clementi" } },
        { data: { id: "+6598765432", telco: "Starhub", location: "Jurong East" } },
        { data: { id: "+6587654321", telco: "M1", location: "Bukit Timah" } },
        { data: { id: "+6581234567", telco: "Singtel", location: "Ang Mo Kio" } },
        { data: { id: "+6593333333", telco: "M1", location: "Woodlands" } },
        { data: { id: "+6599998888", telco: "Starhub", location: "Tampines" } }
      ],
      edges: [
        {
          data: {
            source: "+6591234567",
            target: "+6598765432",
            duration: "180s",
            time: "2025-05-14 08:12"
          }
        },
        {
          data: {
            source: "+6591234567",
            target: "+6587654321",
            duration: "45s",
            time: "2025-05-14 10:03"
          }
        },
        {
          data: {
            source: "+6581234567",
            target: "+6591234567",
            duration: "95s",
            time: "2025-05-14 12:01"
          }
        },
        {
          data: {
            source: "+6587654321",
            target: "+6593333333",
            duration: "300s",
            time: "2025-05-13 21:00"
          }
        },
        {
          data: {
            source: "+6599998888",
            target: "+6591234567",
            duration: "60s",
            time: "2025-05-13 19:45"
          }
        }
      ]
    };

    const cy = cytoscape({
      container: document.getElementById('cy'),
      elements: {
        nodes: data.nodes,
        edges: data.edges.map(e => ({
          data: {
            ...e.data,
            id: `${e.data.source}->${e.data.target}`,
            label: `${e.data.duration} | ${e.data.time}`
          }
        }))
      },
      style: [
        {
          selector: 'node',
          style: {
            'background-color': '#0074D9',
            'label': 'data(id)',
            'color': '#fff',
            'text-outline-width': 1.5,
            'text-outline-color': '#0074D9',
            'text-valign': 'center',
            'text-halign': 'center',
            'font-size': '8px',
            'width': '40px',
            'height': '40px',
            'border-width': 2,
            'border-color': '#fff'
          }
        },
        {
          selector: 'edge',
          style: {
            'width': 2,
            'line-color': '#999',
            'target-arrow-color': '#999',
            'target-arrow-shape': 'triangle',
            'curve-style': 'bezier',
            'label': 'data(label)',
            'font-size': '8px',
            'color': '#333',
            'text-background-color': '#fff',
            'text-background-opacity': 1,
            'text-background-shape': 'roundrectangle',
            'text-border-color': '#ccc',
            'text-border-width': 0.5,
            'text-border-opacity': 1
          }
        }
      ],
      layout: {
        name: 'cose',
        animate: true
      }
    });
  </script>
</body>
</html>
